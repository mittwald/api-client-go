package backupclientv2

// This code was automatically generated by github.com/mittwald/api-client-go-builder.
// DO NOT EDIT.

import (
	"context"
	"encoding/json"
	"net/http"

	"github.com/mittwald/api-client-go/mittwaldv2/generated/schemas/backupv2"
	"github.com/mittwald/api-client-go/pkg/httpclient"
	"github.com/mittwald/api-client-go/pkg/httperr"
)

type Client interface {
	CreateProjectBackupExport(
		ctx context.Context,
		req CreateProjectBackupExportRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	DeleteProjectBackupExport(
		ctx context.Context,
		req DeleteProjectBackupExportRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	ListProjectBackupSchedules(
		ctx context.Context,
		req ListProjectBackupSchedulesRequest,
		reqEditors ...func(req *http.Request) error,
	) (*[]backupv2.ProjectBackupSchedule, *http.Response, error)
	CreateProjectBackupSchedule(
		ctx context.Context,
		req CreateProjectBackupScheduleRequest,
		reqEditors ...func(req *http.Request) error,
	) (*backupv2.ProjectBackupSchedule, *http.Response, error)
	ListProjectBackups(
		ctx context.Context,
		req ListProjectBackupsRequest,
		reqEditors ...func(req *http.Request) error,
	) (*[]backupv2.ProjectBackup, *http.Response, error)
	CreateProjectBackup(
		ctx context.Context,
		req CreateProjectBackupRequest,
		reqEditors ...func(req *http.Request) error,
	) (*backupv2.ProjectBackup, *http.Response, error)
	GetProjectBackupSchedule(
		ctx context.Context,
		req GetProjectBackupScheduleRequest,
		reqEditors ...func(req *http.Request) error,
	) (*backupv2.ProjectBackupSchedule, *http.Response, error)
	DeleteProjectBackupSchedule(
		ctx context.Context,
		req DeleteProjectBackupScheduleRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	UpdateProjectBackupSchedule(
		ctx context.Context,
		req UpdateProjectBackupScheduleRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	GetProjectBackup(
		ctx context.Context,
		req GetProjectBackupRequest,
		reqEditors ...func(req *http.Request) error,
	) (*backupv2.ProjectBackup, *http.Response, error)
	DeleteProjectBackup(
		ctx context.Context,
		req DeleteProjectBackupRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	GetProjectBackupDirectories(
		ctx context.Context,
		req GetProjectBackupDirectoriesRequest,
		reqEditors ...func(req *http.Request) error,
	) (*backupv2.ProjectBackupPath, *http.Response, error)
	RequestProjectBackupRestorePath(
		ctx context.Context,
		req RequestProjectBackupRestorePathRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	UpdateProjectBackupDescription(
		ctx context.Context,
		req UpdateProjectBackupDescriptionRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
	GetProjectBackupDatabaseDumps(
		ctx context.Context,
		req GetProjectBackupDatabaseDumpsRequest,
		reqEditors ...func(req *http.Request) error,
	) (*GetProjectBackupDatabaseDumpsResponse, *http.Response, error)
	RequestProjectBackupRestore(
		ctx context.Context,
		req RequestProjectBackupRestoreRequest,
		reqEditors ...func(req *http.Request) error,
	) (*http.Response, error)
}
type clientImpl struct {
	client httpclient.RequestRunner
}

func NewClient(client httpclient.RequestRunner) Client {
	return &clientImpl{client: client}
}

// Export a ProjectBackup for download.
func (c *clientImpl) CreateProjectBackupExport(
	ctx context.Context,
	req CreateProjectBackupExportRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// Delete a ProjectBackupExport.
func (c *clientImpl) DeleteProjectBackupExport(
	ctx context.Context,
	req DeleteProjectBackupExportRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// List BackupSchedules belonging to a Project.
func (c *clientImpl) ListProjectBackupSchedules(
	ctx context.Context,
	req ListProjectBackupSchedulesRequest,
	reqEditors ...func(req *http.Request) error,
) (*[]backupv2.ProjectBackupSchedule, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response []backupv2.ProjectBackupSchedule
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Create a BackupSchedule for a Project.
func (c *clientImpl) CreateProjectBackupSchedule(
	ctx context.Context,
	req CreateProjectBackupScheduleRequest,
	reqEditors ...func(req *http.Request) error,
) (*backupv2.ProjectBackupSchedule, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response backupv2.ProjectBackupSchedule
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// List Backups belonging to a Project.
func (c *clientImpl) ListProjectBackups(
	ctx context.Context,
	req ListProjectBackupsRequest,
	reqEditors ...func(req *http.Request) error,
) (*[]backupv2.ProjectBackup, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response []backupv2.ProjectBackup
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Create a Backup of a Project.
func (c *clientImpl) CreateProjectBackup(
	ctx context.Context,
	req CreateProjectBackupRequest,
	reqEditors ...func(req *http.Request) error,
) (*backupv2.ProjectBackup, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response backupv2.ProjectBackup
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Get a ProjectBackupSchedule.
func (c *clientImpl) GetProjectBackupSchedule(
	ctx context.Context,
	req GetProjectBackupScheduleRequest,
	reqEditors ...func(req *http.Request) error,
) (*backupv2.ProjectBackupSchedule, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response backupv2.ProjectBackupSchedule
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Delete a ProjectBackupSchedule.
func (c *clientImpl) DeleteProjectBackupSchedule(
	ctx context.Context,
	req DeleteProjectBackupScheduleRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// Update a ProjectBackupSchedule.
func (c *clientImpl) UpdateProjectBackupSchedule(
	ctx context.Context,
	req UpdateProjectBackupScheduleRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// Get a ProjectBackup.
func (c *clientImpl) GetProjectBackup(
	ctx context.Context,
	req GetProjectBackupRequest,
	reqEditors ...func(req *http.Request) error,
) (*backupv2.ProjectBackup, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response backupv2.ProjectBackup
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Delete a ProjectBackup.
func (c *clientImpl) DeleteProjectBackup(
	ctx context.Context,
	req DeleteProjectBackupRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// List paths for a ProjectBackup.
func (c *clientImpl) GetProjectBackupDirectories(
	ctx context.Context,
	req GetProjectBackupDirectoriesRequest,
	reqEditors ...func(req *http.Request) error,
) (*backupv2.ProjectBackupPath, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response backupv2.ProjectBackupPath
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Restore a ProjectBackup's path.
//
// **Deprecated**: Use POST /v2/project-backups/{projectBackupId}/restore instead.
// This endpoint will be removed in a future version.
func (c *clientImpl) RequestProjectBackupRestorePath(
	ctx context.Context,
	req RequestProjectBackupRestorePathRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// Change the description of a ProjectBackup.
func (c *clientImpl) UpdateProjectBackupDescription(
	ctx context.Context,
	req UpdateProjectBackupDescriptionRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}

// List database dump's for a ProjectBackup.
func (c *clientImpl) GetProjectBackupDatabaseDumps(
	ctx context.Context,
	req GetProjectBackupDatabaseDumpsRequest,
	reqEditors ...func(req *http.Request) error,
) (*GetProjectBackupDatabaseDumpsResponse, *http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return nil, httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return nil, httpRes, err
	}

	var response GetProjectBackupDatabaseDumpsResponse
	if err := json.NewDecoder(httpRes.Body).Decode(&response); err != nil {
		return nil, httpRes, err
	}
	return &response, httpRes, nil
}

// Restore a ProjectBackup (path or database).
func (c *clientImpl) RequestProjectBackupRestore(
	ctx context.Context,
	req RequestProjectBackupRestoreRequest,
	reqEditors ...func(req *http.Request) error,
) (*http.Response, error) {
	httpReq, err := req.BuildRequest(reqEditors...)
	if err != nil {
		return nil, err
	}

	httpRes, err := c.client.Do(httpReq.WithContext(ctx))
	if err != nil {
		return httpRes, err
	}

	if httpRes.StatusCode >= 400 {
		err := httperr.ErrFromResponse(httpRes)
		return httpRes, err
	}

	return httpRes, nil
}
